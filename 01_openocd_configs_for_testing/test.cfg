# OpenOCD configuration for Raspberry Pi Zero 2W GPIO as JTAG adapter

# -----------------------------
# Interface/adapter configuration
# -----------------------------
adapter driver bcm2835gpio
transport select jtag

# GPIO mapping (BCM numbering, not pin numbers!)
# Adjust if you wired differently.

adapter gpio tck 4        ;# GPIO4  (pin 7)
adapter gpio tms 3        ;# GPIO3  (pin 5)
adapter gpio tdi 17       ;# GPIO17 (pin 11)
adapter gpio tdo 2        ;# GPIO2  (pin 3)
#bcm2835gpio_trst_num 7   ;# GPIO7  (pin 26) if wired
#bcm2835gpio_srst_num 18  ;# GPIO18 (pin 12) if wired

# Make sure to connect a common ground between Pi and FPGA

# Clock speed (software bit-bang)
adapter speed 1000

# Debug level (1-4)
debug_level 2

# -----------------------------
# Reset configuration
# -----------------------------
# Your Olimex was active-low TRST, design is active-high TRST.
# Since Pi GPIO is flexible, we leave reset as "none" unless needed.
reset_config none  

# -----------------------------
# TAP configuration
# -----------------------------

jtag newtap fpga tap -irlen 4 -expected-id 0x149511c3 -ircapture 0x5 -irmask 0xf


# -----------------------------
# TAP operations
# -----------------------------

init
scan_chain
